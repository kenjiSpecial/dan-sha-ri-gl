!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(t.dsr={})}(this,function(t){"use strict";var r=5126;function e(t){for(var r=t.split("\n"),e=0;e<r.length;e++)r[e]=e+1+": "+r[e];return r.join("\n")}function n(t,r,n){var o=t.createShader(r);return t.shaderSource(o,n),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)?o:(console.error("[WebGLShader]: Shader couldn't compile."),""!==t.getShaderInfoLog(o)?(console.warn("[WebGLShader]: gl.getShaderInfoLog()",r===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(o),e(n)),null):void 0)}var o=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,a=Math.random,u=Object.freeze({EPSILON:o,ARRAY_TYPE:i,RANDOM:a});function c(){var t=new i(16);return i!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function f(t,r,e,n,o){var i=1/Math.tan(r/2),a=void 0;return t[0]=i/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(a=1/(n-o),t[10]=(o+n)*a,t[14]=2*o*n*a):(t[10]=-1,t[14]=-2*n),t}function h(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function s(t,r,e,n){var i=void 0,a=void 0,u=void 0,c=void 0,f=void 0,s=void 0,v=void 0,l=void 0,d=void 0,g=void 0,M=r[0],p=r[1],A=r[2],y=n[0],x=n[1],m=n[2],b=e[0],R=e[1],P=e[2];return Math.abs(M-b)<o&&Math.abs(p-R)<o&&Math.abs(A-P)<o?h(t):(v=M-b,l=p-R,d=A-P,i=x*(d*=g=1/Math.sqrt(v*v+l*l+d*d))-m*(l*=g),a=m*(v*=g)-y*d,u=y*l-x*v,(g=Math.sqrt(i*i+a*a+u*u))?(i*=g=1/g,a*=g,u*=g):(i=0,a=0,u=0),c=l*u-d*a,f=d*i-v*u,s=v*a-l*i,(g=Math.sqrt(c*c+f*f+s*s))?(c*=g=1/g,f*=g,s*=g):(c=0,f=0,s=0),t[0]=i,t[1]=c,t[2]=v,t[3]=0,t[4]=a,t[5]=f,t[6]=l,t[7]=0,t[8]=u,t[9]=s,t[10]=d,t[11]=0,t[12]=-(i*M+a*p+u*A),t[13]=-(c*M+f*p+s*A),t[14]=-(v*M+l*p+d*A),t[15]=1,t)}var v=Object.freeze({create:c,multiply:function(t,r,e){var n=r[0],o=r[1],i=r[2],a=r[3],u=r[4],c=r[5],f=r[6],h=r[7],s=r[8],v=r[9],l=r[10],d=r[11],g=r[12],M=r[13],p=r[14],A=r[15],y=e[0],x=e[1],m=e[2],b=e[3];return t[0]=y*n+x*u+m*s+b*g,t[1]=y*o+x*c+m*v+b*M,t[2]=y*i+x*f+m*l+b*p,t[3]=y*a+x*h+m*d+b*A,y=e[4],x=e[5],m=e[6],b=e[7],t[4]=y*n+x*u+m*s+b*g,t[5]=y*o+x*c+m*v+b*M,t[6]=y*i+x*f+m*l+b*p,t[7]=y*a+x*h+m*d+b*A,y=e[8],x=e[9],m=e[10],b=e[11],t[8]=y*n+x*u+m*s+b*g,t[9]=y*o+x*c+m*v+b*M,t[10]=y*i+x*f+m*l+b*p,t[11]=y*a+x*h+m*d+b*A,y=e[12],x=e[13],m=e[14],b=e[15],t[12]=y*n+x*u+m*s+b*g,t[13]=y*o+x*c+m*v+b*M,t[14]=y*i+x*f+m*l+b*p,t[15]=y*a+x*h+m*d+b*A,t},perspective:f,identity:h,clone:function(t){for(var r=new i(16),e=0;e<r.length;e++)r[e]=t[e];return r},fromTranslation:function(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},fromYRotation:function(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=0,t[2]=-e,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=e,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},lookAt:s,fromRotationTranslationScale:function(t,r,e,n){var o=r[0],i=r[1],a=r[2],u=r[3],c=o+o,f=i+i,h=a+a,s=o*c,v=o*f,l=o*h,d=i*f,g=i*h,M=a*h,p=u*c,A=u*f,y=u*h,x=n[0],m=n[1],b=n[2];return t[0]=(1-(d+M))*x,t[1]=(v+y)*x,t[2]=(l-A)*x,t[3]=0,t[4]=(v-y)*m,t[5]=(1-(s+M))*m,t[6]=(g+p)*m,t[7]=0,t[8]=(l+A)*b,t[9]=(g-p)*b,t[10]=(1-(s+d))*b,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},fromXRotation:function(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=e,t[7]=0,t[8]=0,t[9]=-e,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},targetTo:function(t,r,e,n){var o=r[0],i=r[1],a=r[2],u=n[0],c=n[1],f=n[2],h=o-e[0],s=i-e[1],v=a-e[2],l=h*h+s*s+v*v;l>0&&(h*=l=1/Math.sqrt(l),s*=l,v*=l);var d=c*v-f*s,g=f*h-u*v,M=u*s-c*h;return(l=d*d+g*g+M*M)>0&&(d*=l=1/Math.sqrt(l),g*=l,M*=l),t[0]=d,t[1]=g,t[2]=M,t[3]=0,t[4]=s*M-v*g,t[5]=v*d-h*M,t[6]=h*g-s*d,t[7]=0,t[8]=h,t[9]=s,t[10]=v,t[11]=0,t[12]=o,t[13]=i,t[14]=a,t[15]=1,t},transpose:function(t,r){if(t===r){var e=r[1],n=r[2],o=r[3],i=r[6],a=r[7],u=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=e,t[6]=r[9],t[7]=r[13],t[8]=n,t[9]=i,t[11]=r[14],t[12]=o,t[13]=a,t[14]=u}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t},invert:function(t,r){var e=r[0],n=r[1],o=r[2],i=r[3],a=r[4],u=r[5],c=r[6],f=r[7],h=r[8],s=r[9],v=r[10],l=r[11],d=r[12],g=r[13],M=r[14],p=r[15],A=e*u-n*a,y=e*c-o*a,x=e*f-i*a,m=n*c-o*u,b=n*f-i*u,R=o*f-i*c,P=h*g-s*d,S=h*M-v*d,E=h*p-l*d,_=s*M-v*g,T=s*p-l*g,L=v*p-l*M,k=A*L-y*T+x*_+m*E-b*S+R*P;return k?(k=1/k,t[0]=(u*L-c*T+f*_)*k,t[1]=(o*T-n*L-i*_)*k,t[2]=(g*R-M*b+p*m)*k,t[3]=(v*b-s*R-l*m)*k,t[4]=(c*E-a*L-f*S)*k,t[5]=(e*L-o*E+i*S)*k,t[6]=(M*x-d*R-p*y)*k,t[7]=(h*R-v*x+l*y)*k,t[8]=(a*T-u*E+f*P)*k,t[9]=(n*E-e*T-i*P)*k,t[10]=(d*b-g*x+p*A)*k,t[11]=(s*x-h*b-l*A)*k,t[12]=(u*S-a*_-c*P)*k,t[13]=(e*_-n*S+o*P)*k,t[14]=(g*y-d*m-M*A)*k,t[15]=(h*m-s*y+v*A)*k,t):null}});var l=Object.freeze({create:function(){var t=new i(4);return i!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}});var d=Object.freeze({create:function(){var t=new i(3);return i!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t},add:function(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t},rotateZ:function(t,r,e,n){var o=[],i=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],i[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),i[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),i[2]=o[2],t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t},rotateY:function(t,r,e,n){var o=[],i=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],i[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),i[1]=o[1],i[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),t[0]=i[0]+e[0],t[1]=i[1]+e[1],t[2]=i[2]+e[2],t},transformMat4:function(t,r,e){var n=r[0],o=r[1],i=r[2],a=e[3]*n+e[7]*o+e[11]*i+e[15];return a=a||1,t[0]=(e[0]*n+e[4]*o+e[8]*i+e[12])/a,t[1]=(e[1]*n+e[5]*o+e[9]*i+e[13])/a,t[2]=(e[2]*n+e[6]*o+e[10]*i+e[14])/a,t},normalize:function(t,r){var e=r[0],n=r[1],o=r[2],i=e*e+n*n+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i),t},cross:function(t,r,e){var n=r[0],o=r[1],i=r[2],a=e[0],u=e[1],c=e[2];return t[0]=o*c-i*u,t[1]=i*a-n*c,t[2]=n*u-o*a,t}});var g=Object.freeze({clamp:function(t,r,e){return Math.min(Math.max(t,r),e)},range:function(t,r){return(r-t)*Math.random()+t},calculateCircleCenter:function(t,r,e){var n={},o=(r.y-t.y)/(r.x-t.x),i=(e.y-r.y)/(e.x-r.x);return n.x=(o*i*(t.y-e.y)+i*(t.x+r.x)-o*(r.x+e.x))/(2*(i-o)),n.y=-1*(n.x-(t.x+r.x)/2)/o+(t.y+r.y)/2,n},mix:function(t,r,e){return t*(1-e)+r*e},degToRad:function(t){return.017453292519943295*t},radToDeg:function(t){return 57.29577951308232*t}}),M=function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")},p=function(){function t(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(r,e,n){return e&&t(r.prototype,e),n&&t(r,n),r}}(),A=function(){function t(r,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:45,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3;M(this,t),this.position={x:0,y:0,z:0},this.lookAtPosition={x:0,y:0,z:0},this._viewMatrix=c(),this._projectionMatrix=c(),this.updatePerspective(r,e,n,o,i)}return p(t,[{key:"updatePerspective",value:function(t,r,e,n,o){f(this._projectionMatrix,e/180*Math.PI,t/r,n,o)}},{key:"updatePosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.position.x=t,this.position.y=r,this.position.z=e}},{key:"updateLookAtPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-100;this.lookAtPosition.x=t,this.lookAtPosition.y=r,this.lookAtPosition.z=e}},{key:"updateViewMatrix",value:function(){s(this._viewMatrix,[this.position.x,this.position.y,this.position.z],[this.lookAtPosition.x,this.lookAtPosition.y,this.lookAtPosition.z],[0,1,0])}},{key:"viewMatrix",get:function(){return this._viewMatrix}},{key:"projectionMatrix",get:function(){return this._projectionMatrix}}]),t}();console.log("[danshariGL] version: 0.1.0, %o","https://github.com/kenjiSpecial/tubugl"),t.getUniformLocations=function(t,r,e){for(var n={},o=0;o<e.length;o++){var i=e[o],a=t.getUniformLocation(r,i);n[i]=a}return n},t.addLineNumbers=e,t.compileGLShader=n,t.createPrgoram=function(t,r,e){var o=t.createProgram(),i=n(t,t.VERTEX_SHADER,r),a=n(t,t.FRAGMENT_SHADER,e);t.attachShader(o,i),t.attachShader(o,a),t.linkProgram(o);try{if(!t.getProgramParameter(o,t.LINK_STATUS))throw t.getProgramInfoLog(o)}catch(t){console.error("WebGLProgram: "+t)}return o},t.creteBuffer=function(t,r,e,n){var o=t.createBuffer(),i=t.getAttribLocation(r,n);return t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),{buffer:o,location:i}},t.createIndex=function(t,r){var e=t.createBuffer();return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),t.bufferData(t.ELEMENT_ARRAY_BUFFER,r,t.STATIC_DRAW),{cnt:r.length,buffer:e}},t.bindBuffer=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;t.bindBuffer(t.ARRAY_BUFFER,e),t.vertexAttribPointer(n,o,i,a,u,c),t.enableVertexAttribArray(n)},t.getSphere=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,n=[],o=[],i=[],a=[],u=0;u<=r;++u)for(var c=u*Math.PI/r,f=Math.sin(c),h=Math.cos(c),s=0;s<=e;++s){var v=2*s*Math.PI/e,l=Math.sin(v),d=Math.cos(v)*f,g=h,M=l*f,p=1-s/e,A=1-u/r;i.push(d,g,M),o.push(p,A),n.push(t*d,t*g,t*M)}for(u=0;u<r;++u)for(s=0;s<e;++s){var y=u*(e+1)+s,x=y+e+1;a.push(x,y,y+1,x+1,x,y+1)}return{vertices:n,textures:o,normals:i,indices:a}},t.Camera=A,t.glMatrix=u,t.mat4=v,t.quat=l,t.vec3=d,t.math=g,Object.defineProperty(t,"__esModule",{value:!0})});
